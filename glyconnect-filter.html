<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">

<!--
`glyconnect-filter`
This element provides filter box in glyconnect

@demo demo/index.html 
-->

<dom-module id="glyconnect-filter">
  <template>
    <style is="custom-style" include="iron-flex"></style>
    <style>
      :host {
        display: block;
      }
    </style>
    <iron-ajax
            id="ajaxDictionary"
            handle-as="json"
            method="GET"
            last-response="{{globalDictionary}}"
            on-response="handleResponse"
    ></iron-ajax>
    <div class="horizontal layout">
    <paper-dropdown-menu label="Type" style="padding-right: 10px;">
      <paper-listbox class="dropdown-content" selected="{{typeSelected}}" attr-for-selected="glycantype">
        <template is="dom-repeat" items="{{glycanType}}">
          <paper-item glycantype="{{item.shortName}}">{{item.name}}</paper-item>
        </template>
      </paper-listbox>
    </paper-dropdown-menu>

    <paper-dropdown-menu label="Core" style="padding-right: 10px;">
      <paper-listbox class="dropdown-content" selected="{{coreSelected}}" attr-for-selected="core">
        <template is="dom-repeat" items="{{coreType}}">
          <paper-item core="{{item.shortName}}">{{item.name}}</paper-item>
        </template>
      </paper-listbox>
    </paper-dropdown-menu>

    <paper-dropdown-menu label="Properties">
      <paper-listbox class="dropdown-content" selected="{{propertySelected}}" attr-for-selected="property">
        <template is="dom-repeat" items="{{prop}}">
          <paper-item property="{{item.shortName}}">{{item.name}}</paper-item>
        </template>
      </paper-listbox>
    </paper-dropdown-menu>

    </div>
  </template>

  <script>
    Polymer({

      is: 'glyconnect-filter',

      properties: {
        typeSelected: {
          type: String,
          observer: "_typeChange"
        },
        coreSelected: {
          type: String,
          observer: "_coreSelectedChange"
        },
        propertySelected: {
          type: String,
          observer: "_propertySelectedChange"
        },
        prop: {
          type: String
        }
      },

      attached: function(){
        this.$.ajaxDictionary.url = this.resolveUrl('dictionary/globalDictionary.json');
        this.$.ajaxDictionary.generateRequest();
      },

      handleResponse: function(){
        this.glycanType = this.globalDictionary.type;
      },

      _typeChange: function(){
        console.log(this.typeSelected);
        if(this.typeSelected == 'oglycan'){
          this.coreType = [
            {shortName: 'core0', name: 'Core 1'},
            {shortName: 'core1', name: 'Core 2'},
            {shortName: 'core1', name: 'Core 3'},
        ];
        } else {
          this.coreType = [
            {shortName: 'hybrid', name: 'Hybrid'},
            {shortName: 'complex', name: 'Complex'},
            {shortName: 'hmannose', name: 'High Mannose'}
          ];
        }
      },
      _coreSelectedChange: function(){
        if(this.coreSelected == 'core0'){
          this.prop = [
            {shortName: 'fuco', name: 'Fucosylated'},
            {shortName: 'nonfuco', name: 'Non-fucosylated'},
            {shortName: 'nonsialic', name: 'Non-sialylated'},
        ];
        } else if (this.coreSelected == 'core1'){
          this.prop = [
            {shortName: 'nonfuco', name: 'Non-fucosylated'},
            {shortName: 'nonsialic', name: 'Non-sialylated'},
          ];
        } else if (this.coreSelected == 'core2'){
          this.prop = [
            {shortName: 'nonfuco', name: 'Non-fucosylated'},
            {shortName: 'nonsialic', name: 'Non-sialylated'},
          ];
        } else if (this.coreSelected == 'hybrid'){
          this.prop = [
            {shortName: 'nonfuco', name: 'Non-fucosylated'},
            {shortName: 'nonsialic', name: 'Non-sialylated'},
          ];
        } else if (this.coreSelected == 'complex'){
          this.prop = [
            {shortName: 'nonfuco', name: 'Non-fucosylated'},
            {shortName: 'nonsialic', name: 'Non-sialylated'},
          ];
        }else if (this.coreSelected == 'hmannose'){
          this.prop = [
            {shortName: 'nonfuco', name: 'Non-fucosylated'},
            {shortName: 'nonsialic', name: 'Non-sialylated'},
          ];
        }
        console.log(this.coreSelected);
      },
      _propertySelectedChange: function(){
        console.log(this.propertySelected);
      },
      _filterCall: function(){
        //call server Julien
      }

      /* Possible Advanced Feature
          - server call for populate drop-down multi selections
       */

    });
  </script>
</dom-module>
