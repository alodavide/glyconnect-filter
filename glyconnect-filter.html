<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../paper-header-panel/paper-header-panel.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-collapse/iron-collapse.html">
<link rel="import" href="../sortable-list/sortable-list.html">
<link rel="import" href="../paper-card/paper-card.html">


<!--
`glyconnect-filter`
This element provides filter box in glyconnect

@demo demo/index.html
-->

<dom-module id="glyconnect-filter">
  <template>
    <style is="custom-style" include="iron-flex"></style>
    <style>
      :host {
        display: block;
      }
      iron-icon[disabled]{
        display: none;
      }
      paper-material {
          margin: 20px;
          background-color: #eee;
      }
      .enzymeList{
          padding: 5px;
          @apply(--layout-horizontal);
          @apply(--layout-wrap);
          min-width: 200px;
          min-height: 200px;

          align-content: center;
      }
      .enzymeSelected{
          padding: 5px;
          @apply(--layout-horizontal);
          @apply(--layout-wrap);
          min-height: 300px;
          width: 700px;
          align-items: right;
      }

      paper-toolbar {
          --paper-toolbar-background: #e2011b; /* changes the background to blue*/
      }
      paper-button.indigo {
        background-color: var(--paper-indigo-500);
        color: white;
        --paper-button-raised-keyboard-focus: {
            color: white !important;
        };
      }
      paper-button#filterToggleButton {
        width: 100%;
      }
      ul {
        list-style-type: none;
      }
      .paper-header {
        font-family: "Roboto";
        height: 45px;
        font-size: 20px;The Polymer logo.
        padding: 0 10px;The Polymer logo.
        color: red;
        transition: height 0.2s;
      }
      paper-button#updateButton {
        height: 50%;
        margin: 15px 30px;
      }
      #filterToggleButton {
        min-width: 760px;
      }

      #glycanFilterHeader {
        font-size: 16px;
        font-weight: 500;
        line-height: 25px;
      }
      #glycanFilterBox{
        border: 1px solid black;
        margin-left: 16px;
        margin-right: 36px;
        min-width: 758px;
        border-radius: 0 0 5px 5px;
        border: 1px solid rgba(0, 0, 0, 0.2);
      }
      #rangeBox {
        padding: 30px 20px 20px 20px;
      }
      #clearIcon {
        margin: 10px 10px 0 0;
        float: right;
      }
      .card {
        /*background-color: #cc3300;*/
        font-size: 16px;
        padding: 15px 15px 15px 15px;
        /*box-sizing: border-box;*/
        margin: 10px;
        flex: 0 0 auto;
      }

    </style>
    <iron-ajax
            id="ajaxDictionary"
            handle-as="json"
            method="GET"
            last-response="{{jsonGlobalProperties}}"
            on-response="handleResponse"
    ></iron-ajax>

       <paper-header-panel id="glycanTypeFilter" class="blue" mode="seamed">
               <div id="glycanFilterHeader" class="paper-header">
                   <paper-button id="filterToggleButton" class="indigo" on-click="_toggleNGlycan" toggles raised>
                       <iron-icon id="expandIcon" icon="icons:chevron-right" alt="unfold" ></iron-icon>
                       <iron-icon id="foldIcon" icon="icons:expand-more" alt="fold" disabled></iron-icon>
                       N-linked glycans
                   </paper-button>
               </div>
      </paper-header-panel>
         <iron-collapse id="glycanFilterProp" class="horizontal center-justified">
         <iron-icon id="clearIcon" icon="icons:autorenew" alt="reset" on-click="_reset"></iron-icon>
         <div class="layout horizontal flex" >
          <paper-material elevation="2" style="height: 300px" class="flex">
               <paper-toolbar>
                   <paper-icon-button disabled style="color: white" icon="icons:view-list"></paper-icon-button>
                   <span id=""class="title">N-Glycan</span>
               </paper-toolbar>
               <div><paper-button id="updateButton" class="indigo" on-tap="selectedPropN">Search</paper-button></div>
               <sortable-list id="selectedN" group="test"  animation="150" class="enzymeSelected"></sortable-list>
           </paper-material>
         </div>
         <div class="layout horizontal">
            <paper-material elevation="2" style="height: 100%" class="flex">
                <paper-toolbar>
                    <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                    <span class="title">Core</span>
                </paper-toolbar>
                <sortable-list id="list" group="test" animation="150" >
                    <template is="dom-repeat" items="{{coreTypeN}}">
                      <div data-id$="{{item.name}}" >
                        <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                        <paper-card coreTypeN="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                      </div>
                    </template>
                </sortable-list>
            </paper-material>
            <paper-material elevation="2" style="height: 100%" class="flex">
                <paper-toolbar>
                    <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                    <span class="title">Structural properties</span>
                </paper-toolbar>
                <sortable-list id="list" group="test" animation="150" class="enzymeList" >
                    <template is="dom-repeat" items="{{propN}}">
                      <div data-id$="{{item.name}}" >
                        <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                         <paper-card propN="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                      </div>
                    </template>
                </sortable-list>
            </paper-material>
            <paper-material elevation="2" style="height: 100%" class="flex">
                <paper-toolbar>
                    <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                    <span class="title">Determinants</span>
                </paper-toolbar>
                <sortable-list id="list" group="test" animation="150" class="enzymeList" >
                    <template is="dom-repeat" items="{{detN}}">
                      <div data-id$="{{item.name}}" >
                        <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                         <paper-card detN="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                      </div>
                    </template>
                </sortable-list>
            </paper-material>
        </div>
      </iron-collapse>
      <br><br>
      <paper-header-panel id="glycanTypeFilter" class="blue" mode="seamed">
              <div id="glycanFilterHeader" class="paper-header">
                  <paper-button id="filterToggleButton" class="indigo" on-click="_toggleOGlycan" toggles raised>
                      <iron-icon id="expandIcon" icon="icons:chevron-right" alt="unfold" ></iron-icon>
                      <iron-icon id="foldIcon" icon="icons:expand-more" alt="fold" disabled></iron-icon>
                      O-linked glycans
                  </paper-button>
              </div>
     </paper-header-panel>
        <iron-collapse id="glycanFilterO" class="horizontal center-justified">
        <iron-icon id="clearIcon" icon="icons:autorenew" alt="reset" on-click="_reset"></iron-icon>
        <div class="layout horizontal flex" >
         <paper-material elevation="2" style="height: 200px" class="flex">
              <paper-toolbar>
                  <paper-icon-button disabled style="color: white" icon="icons:view-list"></paper-icon-button>
                  <span class="title">O-Glycan</span>
                  <div><paper-button id="updateButton" class="indigo" on-tap="selectedPropO">Search</paper-button></div>
                  <sortable-list id="selectedO" group="test"  animation="150" class="enzymeSelected"></sortable-list>
              </paper-toolbar>
              <sortable-list group="test"  animation="150" class="enzymeSelected"></sortable-list>
          </paper-material>

        </div>
        <div class="layout horizontal">
           <paper-material elevation="2" style="height: 100%" class="flex">
               <paper-toolbar>
                   <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                   <span class="title">Core</span>
               </paper-toolbar>
               <sortable-list id="list" group="test" animation="150" class="enzymeList" >
                   <template is="dom-repeat" items="{{coreTypeO}}">
                     <div data-id$="{{item.name}}" >
                       <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                       <paper-card coreTypeO="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}} </paper-card>
                     </div>
                   </template>
               </sortable-list>
           </paper-material>
           <paper-material elevation="2" style="height: 100%" class="flex">
               <paper-toolbar>
                   <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                   <span class="title">Structural properties</span>
               </paper-toolbar>
               <sortable-list id="list" group="test" animation="150" class="enzymeList">
                   <template is="dom-repeat" items="{{propO}}">
                     <div data-id$="{{item.name}}" >
                       <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                       <paper-card propO="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                     </div>
                   </template>
               </sortable-list>
           </paper-material>
           <paper-material elevation="2" style="height: 100%" class="flex">
               <paper-toolbar>
                   <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                   <span class="title">Determinants</span>
               </paper-toolbar>
               <sortable-list id="list" group="test" animation="150" class="enzymeList">
                   <template is="dom-repeat" items="{{detO}}">
                     <div data-id$="{{item.name}}" >
                       <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                        <paper-card detO="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                     </div>
                   </template>
               </sortable-list>
           </paper-material>
       </div>
     </iron-collapse>
     <br><br>
     <paper-header-panel id="glycanTypeFilter" class="blue" mode="seamed">
             <div id="glycanFilterHeader" class="paper-header">
                 <paper-button id="filterToggleButton" class="indigo" on-click="_toggleNOGlycan" toggles raised>
                     <iron-icon id="expandIcon" icon="icons:chevron-right" alt="unfold" ></iron-icon>
                     <iron-icon id="foldIcon" icon="icons:expand-more" alt="fold" disabled></iron-icon>
                     Non-attached to proteins
                 </paper-button>
             </div>
    </paper-header-panel>
       <iron-collapse id="glycanFilterNO" class="horizontal center-justified">
       <iron-icon id="clearIcon" icon="icons:autorenew" alt="reset" on-click="_reset"></iron-icon>
       <div class="layout horizontal flex" >
        <paper-material elevation="2" style="height: 200px" class="flex">
             <paper-toolbar>
                 <paper-icon-button disabled style="color: white" icon="icons:view-list"></paper-icon-button>
                 <span class="title"> Non-attached to proteins</span>
                 <div><paper-button id="updateButton" class="indigo" on-tap="selectedPropNP">Search</paper-button></div>
                 <sortable-list id="selectedNP" group="test"  animation="150" class="enzymeSelected"></sortable-list>
             </paper-toolbar>
             <sortable-list group="test"  animation="150" class="enzymeSelected"></sortable-list>
         </paper-material>

       </div>
       <div class="layout horizontal">
          <paper-material elevation="2" style="height: 100%" class="flex">
              <paper-toolbar>
                  <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                  <span class="title">Core</span>
              </paper-toolbar>
              <sortable-list id="list" group="test" animation="150" class="enzymeList" >
                  <template is="dom-repeat" items="{{coreTypeNO}}">
                    <div data-id$="{{item.name}},{{item.color}}" >
                      <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                      <paper-card coreTypeNO="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                    </div>
                  </template>
              </sortable-list>
          </paper-material>
          <paper-material elevation="2" style="height: 100%" class="flex">
              <paper-toolbar>
                  <paper-icon-button disabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                  <span class="title">Structural properties</span>
              </paper-toolbar>
              <sortable-list id="list" group="test" animation="150" class="enzymeList">
                  <template is="dom-repeat" items="{{propNO}}">
                    <div data-id$="{{item.name}},{{item.color}}" >
                      <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                      <paper-card propNO="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                    </div>
                  </template>
              </sortable-list>
          </paper-material>
          <paper-material elevation="2" style="height: 100%" class="flex">
              <paper-toolbar>
                  <paper-icon-button dupdateButtonisabled icon="icons:folder-open" style="color: white"></paper-icon-button>
                  <span class="title">Determinants</span>
              </paper-toolbar>
              <sortable-list id="list" group="test" animation="150" class="enzymeList" >
                  <template is="dom-repeat" items="{{detNO}}">
                    <div data-id$="{{item.name}},{{item.color}}" >
                      <!--Important: do not change data-id because it is used for generating the array in Sortable.toArray(). -->
                      <paper-card detNO="{{item}}" class="card" style$="background-color:{{item.color}}">{{item.name}}</paper-card>
                    </div>
                  </template>
              </sortable-list>
          </paper-material>
      </div>
    </iron-collapse>
  </template>

  <script>
    Polymer({

      is: 'glyconnect-filter',
      selectedPropN: function(){
          console.log(this.$.selectedN._sortable.toArray());
          // return this.$.selected._sortable.toArray();
      },
      selectedPropO: function(){
          console.log(this.$.selectedO._sortable.toArray());
          // return this.$.selected._sortable.toArray();
      },

      queryBuild: function() {
        for (i = 0; i < temporary.length; i++) {
          var que = temporary[i]+colorToName[keys[i]];
          console.log(que);
          queries.push(que);
        };
      },
      attached: function(){
        this.$.ajaxDictionary.url = this.resolveUrl('dictionary/jsonGlobalProperties.json');
        this.$.ajaxDictionary.generateRequest();
      },
      handleResponse: function(){
        this.coreTypeO = this.jsonGlobalProperties['O-linked']['core'];
        this.coreTypeN = this.jsonGlobalProperties['N-linked']['core'];
        this.propO = this.jsonGlobalProperties['O-linked']['prop'];
        this.propN = this.jsonGlobalProperties['N-linked']['prop'];
        this.detO = this.jsonGlobalProperties['O-linked']['det'];
        this.detN = this.jsonGlobalProperties['N-linked']['det'];
        this.propNO = this.jsonGlobalProperties['Non attached to proteins']['prop'];
        this.detNO = this.jsonGlobalProperties['Non attached to proteins']['det'];
        this.coreTypeNO = this.jsonGlobalProperties['Non attached to proteins']['core'];
      },

      _toggleNGlycan: function () {
        this.$.glycanFilterProp.toggle();
        if(this.$.foldIcon.hasAttribute('disabled')){
            this.$.expandIcon.setAttribute('disabled', 'true');
            this.$.foldIcon.removeAttribute('disabled');
        }else{
            this.$.foldIcon.setAttribute('disabled', 'true');
            this.$.expandIcon.removeAttribute('disabled');
        }
      },
      _toggleOGlycan: function () {
        this.$.glycanFilterO.toggle();
        if(this.$.foldIcon.hasAttribute('disabled')){
            this.$.expandIcon.setAttribute('disabled', 'true');
            this.$.foldIcon.removeAttribute('disabled');
        }else{
            this.$.foldIcon.setAttribute('disabled', 'true');
            this.$.expandIcon.removeAttribute('disabled');
        }
      },
      _toggleNOGlycan: function () {
        this.$.glycanFilterNO.toggle();
        if(this.$.foldIcon.hasAttribute('disabled')){
            this.$.expandIcon.setAttribute('disabled', 'true');
            this.$.foldIcon.removeAttribute('disabled');
        }else{
            this.$.foldIcon.setAttribute('disabled', 'true');
            this.$.expandIcon.removeAttribute('disabled');
        }
      },
      // _reset: function () {
      //   this.typeSelected = null;
      //   this.coreSelected = null;
      //   this.propertySelected = null;
      //   this.deterSelected = null;
      // },
      // _typeChange: function(){
      //   this.coreType = this.globalDictionary[this.typeSelected];
      // },
      //
      // _coreSelectedChange: function(){
      //   this.prop = this.globalDictionary[this.typeSelected+'_'+this.coreSelected];
      // },
      // _propertySelectedChange: function(){
      //   this.deter = this.globalDictionary[this.typeSelected+'_'+this.coreSelected+'_'+this.propertySelected];
      // },
      // _generate: function(){
      //     console.loge(deter)
      //
      // },
      // (function (document) {
      // 'use strict';
      // document.addEventListener('WebComponentsReady', function() {
      //
      //     // We have to bind the template with the model
      //     var t = document.querySelector('#t');
      //     var ajaxRequest = t.$.dataAjax;
      //
      //     // make the iron-ajax call
      //     t.postData = function() {
      //       ajaxRequest.body = {
      //         'text': t.dataToPost;
      //       }
      //       ajaxRequest.generateRequest();
      //     }
      //
      //     //callback on request complete
      //     t.postComplete = function(){
      //       alert('whoa! request complete');
      //     }
      // });
      // })(document);

      /* Possible Advanced Feature
          - server call for populate drop-down multi selections
       */

    });
  </script>
</dom-module>
